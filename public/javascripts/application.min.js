function getCookie(a){for(var b=document.cookie.split("; "),c=0;c<b.length;c++){var e=b[c],d=e.indexOf("=");if(e.substring(0,d)===a)return e.substring(d+1)}return null}function setCookie(a,b,c){a=escape(a)+"="+escape(b||"")+";";c&&(b=new Date,b.setTime(b.getTime()+1E3*parseInt(c)),a=a+" expires="+b.toGMTString()+";");a+=" path=/;";return document.cookie=a}function deleteCookie(a){return setCookie(a,null,-86400)}
function setUpLoginLogoutLinks(){var a=getCookie("user_id");a===null||a===""?$("#logout").remove():$("#login").remove()}function insertFlash(a,b){b&&$("#cacheable-flash").append($("<div/>",{"class":a,html:b}))}function displayCacheableFlash(){var a=getCookie("flash");a&&(a=unescape(a).replace(/\+/g," "),a=eval("flash = "+a+";"),insertFlash("error",a.error),insertFlash("notice",a.notice),deleteCookie("flash"))}
$.fn.relativizeDates=function(){this.find(".relative-date").removeClass("relative-date").addClass("relativized-date").each(function(){var a=this.innerHTML,b=new Date,c;c=(c=a.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) UTC/))?new Date(Date.UTC(parseInt(c[1]),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),parseInt(c[6],10))):new Date;b=b.getTime()-c.getTime();b=Math.round(b/1E3);b<0?a="in the future":b===0?a="now":b<60?a="a few seconds ago":b<120?a="a minute ago":
b<180?a="a couple of minutes ago":b<300?a="a few minutes ago":b<3600?a=Math.round(b/60)+" minutes ago":b<7200?a="an hour ago":b<86400?a=Math.round(b/3600)+" hours ago":(b=Math.round(b/86400),b===1?a="yesterday":b<=7?a=b+" days ago":(b=Math.round(b/7),a=b===1?"a week ago":b<=6?b+" weeks ago":c.toLocaleDateString()));this.title=c.toLocaleString();this.innerHTML=a});return this};
$.fn.syntaxHighlight=function(){var a={};a["c-syntax"]={preprocessor:/^\s*#.*/m,comment:/\/\/.*|\/\*([^\*]|\*(?!\/))*\*\//,"string-literal":/("(<a .+?a>|[^"\\]|\\.)*"|'([^'\\]|\\.)?')/,keyword:/\b(_Bool|bool|char|const|int|long|short|struct|typedef|unsigned|void)\b/,statement:/\b(break|case|continue|default|do|else|for|goto|if|return|sizeof|static|switch|while)\b/,"boolean":/\b(true|false)\b/,"numeric-literal":/\b(0[xX][a-fA-F0-9]+|\d+(\.\d+f?)?)\b/};a["diff-syntax"]={"skip-header":/^(---|\+\+\+) .*/m,
deleted:/^-.*/m,added:/^\+.*/m,"hunk-header":/^@@ -\d+(,\d+) \+\d+(,\d+) @@.*/m};a["objc-syntax"]=$.extend({},a["c-syntax"],{keyword:/\b(_Bool|BOOL|bool|char|const|int|long|short|struct|typedef|unsigned|void)\b/,"boolean":/\b(YES|NO|true|false)\b/});a["ruby-syntax"]={"skip-anchor":/<a .+?a>/,"skip-entities":/&\w+;/,comment:/#.*/,"string-literal":/("(<a .+?a>|[^"\\]|\\.)*"|'(<a .+?a>|[^'\\]|\\.)*')/,keyword:/\b(begin|break|catch|class|continue|def|else|end|for|if|include|load|module|raise|redo|require|rescue|retry|then|throw|unless|until|while|yield)\b/,
statement:/\b(private|protected|public)\b/,"boolean":/\b(true|false)\b/,constant:/\b[A-Z][a-zA-Z0-9_]*\b/,namespace:/::/,identifier:/(\$|@{1,2})[a-z_][a-zA-Z0-9_]*\b/,symbol:/:[a-zA-Z_][a-zA-Z0-9_]*\b/,"numeric-literal":/\b(0[xX][a-fA-F0-9]+(_[a-fA-F0-9]+)*|0[bB][0-1]+(_[0-1]+)*|[0-9]+(_[0-9]+)*(\.[0-9]+(_[0-9]+)*)?)\b/};a["shell-syntax"]={output:/^[^#\$\n].*/m,constant:/(\\\n|.)+/m};this.find("pre[class$=syntax][class!=highlighted]").each(function(){var b;b=this.innerHTML;var c=a[$(this).attr("class")];
if(c){for(var e="";b!=="";){var d=null,f=null,h;for(h in c){var g=b.match(c[h]);if(g&&(d&&g.index<d||!d))if(d=g.index,g.rule=h,f=g,d===0)break}if(f)d='<span class="'+f.rule+'-syntax">',g="</span>",f.rule.match(/^skip-/)&&(g=d=""),e=e+b.substring(0,f.index)+d+f[0]+g,b=b.substring(f.index+f[0].length);else{e+=b;break}}b=e}this.innerHTML='<span class="line-number"></span>'+b.split("\n").join('\n<span class="line-number"></span>');$(this).addClass("highlighted")});return this};
function setUpSearchLink(){$("#search-link").click(function(){$("#search_box").toggle().focus();return!1})}function highlightActiveFragment(){var a=window.location.hash;a.length>=2&&$(a).addClass("active-fragment")}
$(document).ready(function(){setUpLoginLogoutLinks();setUpSearchLink();displayCacheableFlash();highlightActiveFragment();$("body").syntaxHighlight().relativizeDates();$("input[data-confirm]").live("click",function(){return confirm($(this).attr("data-confirm"))});$("form[data-remote]").live("submit",function(a){var b=$(this),c=b.find("input[type=submit]");if(c.hasClass("disabled"))return!1;c.addClass("disabled");$.ajax({url:b.attr("action")+".js",type:"post",data:b.serialize(),error:function(){alert("Form submission failed")},
complete:function(){c.removeClass("disabled")}});a.preventDefault()});$("a[data-popup]").live("click",function(){window.open(this.href,null,$(this).attr("data-popup"));return!1})});
