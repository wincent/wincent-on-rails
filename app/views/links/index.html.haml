-content_for :javascript do
  =javascript_include_tag 'ajax'
  :javascript
    $(document).ready(function() {
      edit_in_place('tr.link', 'link', 'uri', '/links/');
      edit_in_place('tr.link', 'link', 'permalink', '/links/');
    });
-@page_title = 'Link administration'
=breadcrumbs link_to('Dashboard', admin_dashboard_path), @page_title
#ajax-flash
%h1.major=@page_title
%table
  %thead
    %tr
      -sortable_header_cell :id, 'Id'
      -sortable_header_cell :uri, 'URI'
      -sortable_header_cell :permalink, 'Permalink'
      -sortable_header_cell :click_count, 'Click count'
      %th Actions
  -unless @links.empty?
    %tbody
    -for link in @links
      %tr(class="link #{cycle('odd', 'even')}" id="link_#{link.id}")
        %td=link.id
        %td(id="link_#{link.id}_uri")=link.uri
        %td(id="link_#{link.id}_permalink")=link.permalink
        %td=link.click_count
        %td.links
          =link_to 'edit', edit_link_path(link)
          -# TODO: turn this into a real form; these confirm alerts aren't enough
          -# alternatively, use the delete-but-offer-undo model
          -# BUG: LinksController destroy action isn't implemented yet
          =button_to 'destroy', link, :confirm => 'Are you sure?',
            :method => :delete, :class => 'destructive'
.links
  =link_to 'new link', new_link_path
