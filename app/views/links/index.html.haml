-content_for :javascript do
  =javascript_include_tag 'ajax'
  :javascript
    $(document).ready(function() {
      edit_in_place('tr.link', 'link', 'uri', '/links/');
      edit_in_place('tr.link', 'link', 'permalink', '/links/');
    });
#ajax-flash
%h1 Links
%table
  %tr
    -sortable_header_cell :id, 'Id'
    -sortable_header_cell :uri, 'URI'
    -sortable_header_cell :permalink, 'Permalink'
    -sortable_header_cell :click_count, 'Click count'
    %th Actions
  -for @link in @links
    %tr(class="link #{cycle('odd', 'even')}" id="link_#{@link.id}")
      %td=@link.id
      %td(id="link_#{@link.id}_uri")=h @link.uri
      %td(id="link_#{@link.id}_permalink")=h @link.permalink
      %td=@link.click_count
      %td
        =link_to 'edit', edit_link_path(@link)
        &nbsp;|&nbsp;
        -# TODO: turn this into a real form; these confirm alerts aren't enough
        -# alternatively, use the delete-but-offer-undo model
        =link_to 'destroy', @link, :confirm => 'Are you sure?', :method => :delete
%p=link_to 'new', new_link_path
