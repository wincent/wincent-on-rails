%h1 Edit post
=error_messages_for :post
-form_for @post, :url => post_url, :method => 'put' do |f|
  %table.main
    %tr
      %th Title
      %td=f.text_field :title
    %tr
      %th
        Permalink
        %br
        %span.annotation (optional)
      %td=f.text_field :permalink
    %tr
      %th
        Excerpt
        %br
        %span.annotation==(#{wikitext_cheatsheet})
      %td=f.text_area(:excerpt, :cols => 80)
    %tr
      %th
        Body
        %br
        %span.annotation link to wikitext markup help
      / TODO: make text area grow with window
      %td=f.text_area(:body, :cols => 80, :rows => 30)
    %tr
      %th Tags
      %td=f.text_field :pending_tags
    %tr
      %th Public
      %td=f.check_box :public
    %tr
      %th Accepts comments
      %td=f.check_box :accepts_comments
  %p=f.submit 'Save'
%h2
  ==Preview (#{link_to_update_preview})
  =observe_excerpt
  =observe_body
  =image_tag 'spinner.gif', :id => 'spinner', :style => 'display:none;'
  / TODO: graceful non-JS fallback
#preview=excerpt_and_body_html
.links
  =link_to 'back', posts_url, :class => 'back_link'
  =link_to 'show', post_url(@post), :class => 'show_link'
